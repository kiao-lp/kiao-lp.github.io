<!DOCTYPE html><html><head>
      <title>2507-hexagonal-architecture-with-spring-kafka</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////home/nicolas/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.8.18/crossnote/dependencies/katex/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="experience-report-hexagonal-architecture">Experience Report: Hexagonal Architecture </h1>
<h2 id="context">Context </h2>
<p>I’ve known about hexagonal architecture conceptually for several years, but I had never seen it applied in practice. While its principles align well with Domain-Driven Design (especially since it promotes isolating business logic from representation), companies that focus on designing applications typically emphasize DDD exclusively.</p>
<p>So, when the course I’m taking outside of work at CNAM (GLG204) introduced its use, I envisioned organizing KIAO’s microservices based on hexagonal architecture. After providing a quick explanation of what it is and how I applied it, I’ll share the results I obtained.</p>
<h2 id="hexagonal-architecture">Hexagonal Architecture </h2>
<p>The idea of hexagonal architecture can be summarized simply:<br>
It involves dividing the system into two parts:</p>
<ul>
<li>A <strong>core</strong>, which implements the business logic.</li>
<li>Components that connect this core to the external environment. These components are called <strong>adapters</strong>.</li>
</ul>
<p>Since adapters are modular and interchangeable, they are less generic than the core, which must not access them directly. That’s why the core defines abstract representations called <strong>ports</strong>, which the adapters implement. Dependency injection links everything together.</p>
<h2 id="applying-hexagonal-architecture-to-a-springjpakafka-service">Applying Hexagonal Architecture to a Spring/JPA/Kafka Service </h2>
<p>KIAO’s services include design concepts from:</p>
<ul>
<li>JPA (entities/repositories)</li>
<li>Kafka (producers, consumers)</li>
<li>Typical Spring service structure (controllers)</li>
</ul>
<p>I wanted to structure them according to hexagonal architecture.</p>
<p>To accommodate all these constraints, I arrived at the following organization:</p>
<p class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="CLASS" height="601px" preserveAspectRatio="none" style="width:797px;height:601px;background:#FFFFFF;" version="1.1" viewBox="0 0 797 601" width="797px" zoomAndPan="magnify"><defs><filter height="300%" id="fjvlpem0lm7wz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"></feGaussianBlur><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></feColorMatrix><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"></feOffset><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"></feBlend></filter></defs><g><!--cluster microservice--><g id="cluster_microservice"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="16,6.602,105.3977,6.602,112.3977,31.6699,780,31.6699,780,592.602,16,592.602,16,6.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="16" x2="112.3977" y1="31.6699" y2="31.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83.3977" x="20" y="23.5679">microservice</text></g><!--cluster core--><g id="cluster_core"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="372,232.602,406.8679,232.602,413.8679,257.6699,704,257.6699,704,568.602,372,568.602,372,232.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="372" x2="413.8679" y1="257.6699" y2="257.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28.8679" x="376" y="249.5679">core</text></g><!--cluster business--><g id="cluster_business"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="396,278.602,459.5398,278.602,466.5398,303.6699,680,303.6699,680,434.602,396,434.602,396,278.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="396" x2="466.5398" y1="303.6699" y2="303.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5398" x="400" y="295.5679">business</text></g><!--cluster entities--><g id="cluster_entities"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="554,324.602,608.4818,324.602,615.4818,349.6699,656,349.6699,656,410.602,554,410.602,554,324.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="554" x2="615.4818" y1="349.6699" y2="349.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.4818" x="558" y="341.5679">entities</text></g><!--cluster services--><g id="cluster_services"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="420,324.602,478.4298,324.602,485.4298,349.6699,530,349.6699,530,410.602,420,410.602,420,324.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="420" x2="485.4298" y1="349.6699" y2="349.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.4298" x="424" y="341.5679">services</text></g><!--cluster ports--><g id="cluster_ports"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="396,458.602,436.6219,458.602,443.6219,483.6699,648,483.6699,648,544.602,396,544.602,396,458.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="396" x2="443.6219" y1="483.6699" y2="483.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34.6219" x="400" y="475.5679">ports</text></g><!--cluster adapters--><g id="cluster_adapters"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="40,52.602,104.3658,52.602,111.3658,77.6699,756,77.6699,756,208.602,40,208.602,40,52.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="40" x2="111.3658" y1="77.6699" y2="77.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.3658" x="44" y="69.5679">adapters</text></g><!--cluster data--><g id="cluster_data"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="64,98.602,99.3719,98.602,106.3719,123.6699,220,123.6699,220,184.602,64,184.602,64,98.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="64" x2="106.3719" y1="123.6699" y2="123.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.3719" x="68" y="115.5679">data</text></g><!--cluster kafka--><g id="cluster_kafka"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="244,98.602,285.4759,98.602,292.4759,123.6699,578,123.6699,578,184.602,244,184.602,244,98.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="244" x2="292.4759" y1="123.6699" y2="123.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35.4759" x="248" y="115.5679">kafka</text></g><!--cluster rest--><g id="cluster_rest"><polygon fill="transparent" filter="url(#fjvlpem0lm7wz)" points="602,98.602,633.4379,98.602,640.4379,123.6699,732,123.6699,732,184.602,602,184.602,602,98.602" style="stroke:#000000;stroke-width:1.5;"></polygon><line style="stroke:#000000;stroke-width:1.5;" x1="602" x2="640.4379" y1="123.6699" y2="123.6699"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25.4379" x="606" y="115.5679">rest</text></g><!--class Entity--><g id="elem_Entity"><rect codeline="11" fill="#FEFECE" filter="url(#fjvlpem0lm7wz)" height="32" id="Entity" style="stroke:#A80036;stroke-width:1;" width="69.2959" x="570.5" y="362.602"></rect><ellipse cx="585.5" cy="378.602" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1;"></ellipse><path d="M588.4688,384.2426 Q587.8906,384.5395 587.25,384.6801 Q586.6094,384.8364 585.9063,384.8364 Q583.4063,384.8364 582.0781,383.1957 Q580.7656,381.5395 580.7656,378.4145 Q580.7656,375.2895 582.0781,373.6332 Q583.4063,371.977 585.9063,371.977 Q586.6094,371.977 587.25,372.1332 Q587.9063,372.2895 588.4688,372.5864 L588.4688,375.3051 Q587.8438,374.727 587.25,374.4614 Q586.6563,374.1801 586.0313,374.1801 Q584.6875,374.1801 584,375.2582 Q583.3125,376.3207 583.3125,378.4145 Q583.3125,380.5082 584,381.5864 Q584.6875,382.6489 586.0313,382.6489 Q586.6563,382.6489 587.25,382.3832 Q587.8438,382.102 588.4688,381.5239 L588.4688,384.2426 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.2959" x="599.5" y="384.034">Entity</text></g><!--class Service--><g id="elem_Service"><rect codeline="15" fill="#FEFECE" filter="url(#fjvlpem0lm7wz)" height="32" id="Service" style="stroke:#A80036;stroke-width:1;" width="78.7038" x="435.5" y="362.602"></rect><ellipse cx="450.5" cy="378.602" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1;"></ellipse><path d="M453.4688,384.2426 Q452.8906,384.5395 452.25,384.6801 Q451.6094,384.8364 450.9063,384.8364 Q448.4063,384.8364 447.0781,383.1957 Q445.7656,381.5395 445.7656,378.4145 Q445.7656,375.2895 447.0781,373.6332 Q448.4063,371.977 450.9063,371.977 Q451.6094,371.977 452.25,372.1332 Q452.9063,372.2895 453.4688,372.5864 L453.4688,375.3051 Q452.8438,374.727 452.25,374.4614 Q451.6563,374.1801 451.0313,374.1801 Q449.6875,374.1801 449,375.2582 Q448.3125,376.3207 448.3125,378.4145 Q448.3125,380.5082 449,381.5864 Q449.6875,382.6489 451.0313,382.6489 Q451.6563,382.6489 452.25,382.3832 Q452.8438,382.102 453.4688,381.5239 L453.4688,384.2426 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.7038" x="464.5" y="384.034">Service</text></g><!--class Repository--><g id="elem_Repository"><rect codeline="20" fill="#FEFECE" filter="url(#fjvlpem0lm7wz)" height="32" id="Repository" style="stroke:#A80036;stroke-width:1;" width="97.2958" x="411.5" y="496.602"></rect><ellipse cx="426.5" cy="512.602" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1;"></ellipse><path d="M422.4219,508.3676 L422.4219,506.2114 L429.8125,506.2114 L429.8125,508.3676 L427.3438,508.3676 L427.3438,516.4457 L429.8125,516.4457 L429.8125,518.602 L422.4219,518.602 L422.4219,516.4457 L424.8906,516.4457 L424.8906,508.3676 L422.4219,508.3676 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="65.2958" x="440.5" y="518.034">Repository</text></g><!--class Producer--><g id="elem_Producer"><rect codeline="22" fill="#FEFECE" filter="url(#fjvlpem0lm7wz)" height="32" id="Producer" style="stroke:#A80036;stroke-width:1;" width="88.5038" x="543.5" y="496.602"></rect><ellipse cx="558.5" cy="512.602" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1;"></ellipse><path d="M554.4219,508.3676 L554.4219,506.2114 L561.8125,506.2114 L561.8125,508.3676 L559.3438,508.3676 L559.3438,516.4457 L561.8125,516.4457 L561.8125,518.602 L554.4219,518.602 L554.4219,516.4457 L556.8906,516.4457 L556.8906,508.3676 L554.4219,508.3676 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="56.5038" x="572.5" y="518.034">Producer</text></g><!--class JpaRepository--><g id="elem_JpaRepository"><rect codeline="29" fill="#FEFECE" filter="url(#fjvlpem0lm7wz)" height="32" id="JpaRepository" style="stroke:#A80036;stroke-width:1;" width="122.7337" x="80.5" y="136.602"></rect><ellipse cx="95.5" cy="152.602" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1;"></ellipse><path d="M98.4688,158.2426 Q97.8906,158.5395 97.25,158.6801 Q96.6094,158.8364 95.9063,158.8364 Q93.4063,158.8364 92.0781,157.1957 Q90.7656,155.5395 90.7656,152.4145 Q90.7656,149.2895 92.0781,147.6332 Q93.4063,145.977 95.9063,145.977 Q96.6094,145.977 97.25,146.1332 Q97.9063,146.2895 98.4688,146.5864 L98.4688,149.3051 Q97.8438,148.727 97.25,148.4614 Q96.6563,148.1801 96.0313,148.1801 Q94.6875,148.1801 94,149.2582 Q93.3125,150.3207 93.3125,152.4145 Q93.3125,154.5082 94,155.5864 Q94.6875,156.6489 96.0313,156.6489 Q96.6563,156.6489 97.25,156.3832 Q97.8438,156.102 98.4688,155.5239 L98.4688,158.2426 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.7337" x="109.5" y="158.034">JpaRepository</text></g><!--class KafkaProducer--><g id="elem_KafkaProducer"><rect codeline="34" fill="#FEFECE" filter="url(#fjvlpem0lm7wz)" height="32" id="KafkaProducer" style="stroke:#A80036;stroke-width:1;" width="129.0476" x="260.5" y="136.602"></rect><ellipse cx="275.5" cy="152.602" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1;"></ellipse><path d="M278.4688,158.2426 Q277.8906,158.5395 277.25,158.6801 Q276.6094,158.8364 275.9063,158.8364 Q273.4063,158.8364 272.0781,157.1957 Q270.7656,155.5395 270.7656,152.4145 Q270.7656,149.2895 272.0781,147.6332 Q273.4063,145.977 275.9063,145.977 Q276.6094,145.977 277.25,146.1332 Q277.9063,146.2895 278.4688,146.5864 L278.4688,149.3051 Q277.8438,148.727 277.25,148.4614 Q276.6563,148.1801 276.0313,148.1801 Q274.6875,148.1801 274,149.2582 Q273.3125,150.3207 273.3125,152.4145 Q273.3125,154.5082 274,155.5864 Q274.6875,156.6489 276.0313,156.6489 Q276.6563,156.6489 277.25,156.3832 Q277.8438,156.102 278.4688,155.5239 L278.4688,158.2426 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.0476" x="289.5" y="158.034">KafkaProducer</text></g><!--class KafkaConsumer--><g id="elem_KafkaConsumer"><rect codeline="35" fill="#FEFECE" filter="url(#fjvlpem0lm7wz)" height="32" id="KafkaConsumer" style="stroke:#A80036;stroke-width:1;" width="136.7616" x="424.5" y="136.602"></rect><ellipse cx="439.5" cy="152.602" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1;"></ellipse><path d="M442.4688,158.2426 Q441.8906,158.5395 441.25,158.6801 Q440.6094,158.8364 439.9063,158.8364 Q437.4063,158.8364 436.0781,157.1957 Q434.7656,155.5395 434.7656,152.4145 Q434.7656,149.2895 436.0781,147.6332 Q437.4063,145.977 439.9063,145.977 Q440.6094,145.977 441.25,146.1332 Q441.9063,146.2895 442.4688,146.5864 L442.4688,149.3051 Q441.8438,148.727 441.25,148.4614 Q440.6563,148.1801 440.0313,148.1801 Q438.6875,148.1801 438,149.2582 Q437.3125,150.3207 437.3125,152.4145 Q437.3125,154.5082 438,155.5864 Q438.6875,156.6489 440.0313,156.6489 Q440.6563,156.6489 441.25,156.3832 Q441.8438,156.102 442.4688,155.5239 L442.4688,158.2426 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.7616" x="453.5" y="158.034">KafkaConsumer</text></g><!--class Controller--><g id="elem_Controller"><rect codeline="39" fill="#FEFECE" filter="url(#fjvlpem0lm7wz)" height="32" id="Controller" style="stroke:#A80036;stroke-width:1;" width="98.1777" x="618" y="136.602"></rect><ellipse cx="633" cy="152.602" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1;"></ellipse><path d="M635.9688,158.2426 Q635.3906,158.5395 634.75,158.6801 Q634.1094,158.8364 633.4063,158.8364 Q630.9063,158.8364 629.5781,157.1957 Q628.2656,155.5395 628.2656,152.4145 Q628.2656,149.2895 629.5781,147.6332 Q630.9063,145.977 633.4063,145.977 Q634.1094,145.977 634.75,146.1332 Q635.4063,146.2895 635.9688,146.5864 L635.9688,149.3051 Q635.3438,148.727 634.75,148.4614 Q634.1563,148.1801 633.5313,148.1801 Q632.1875,148.1801 631.5,149.2582 Q630.8125,150.3207 630.8125,152.4145 Q630.8125,154.5082 631.5,155.5864 Q632.1875,156.6489 633.5313,156.6489 Q634.1563,156.6489 634.75,156.3832 Q635.3438,156.102 635.9688,155.5239 L635.9688,158.2426 Z " fill="#000000"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.1777" x="647" y="158.034">Controller</text></g><!--link JpaRepository to Repository--><g id="link_JpaRepository_Repository"><path codeline="43" d="M147.71,168.842 C165.9,215.552 226.74,358.662 319,442.602 C346.21,467.362 367.1309,478.7536 396.7109,490.0836 " fill="transparent" id="JpaRepository-to-Repository" style="stroke:#A80036;stroke-width:1;stroke-dasharray:7.0,7.0;"></path><polygon fill="transparent" points="413.52,496.522,398.857,484.4805,394.5647,495.6866,413.52,496.522" style="stroke:#A80036;stroke-width:1;"></polygon></g><!--link KafkaProducer to Producer--><g id="link_KafkaProducer_Producer"><path codeline="44" d="M324.65,168.762 C324.41,217.792 331.01,372.922 420,442.602 C438.6,457.162 504.49,440.832 526,450.602 C548,460.592 555.9216,467.5208 566.8616,482.1108 " fill="transparent" id="KafkaProducer-to-Producer" style="stroke:#A80036;stroke-width:1;stroke-dasharray:7.0,7.0;"></path><polygon fill="transparent" points="577.66,496.512,571.662,478.5113,562.0612,485.7103,577.66,496.512" style="stroke:#A80036;stroke-width:1;"></polygon></g><!--link Controller to Service--><g id="link_Controller_Service"><path codeline="45" d="M648.93,168.822 C631.63,182.782 604.34,203.262 578,216.602 C567.97,221.682 562.54,217.292 554,224.602 C509.71,262.512 488.6224,325.649 480.3424,356.349 " fill="transparent" id="Controller-to-Service" style="stroke:#A80036;stroke-width:1;"></path><polygon fill="#A80036" points="478.78,362.142,484.9856,354.4941,480.082,357.3145,477.2616,352.4109,478.78,362.142" style="stroke:#A80036;stroke-width:1;"></polygon></g><!--link KafkaConsumer to Service--><g id="link_KafkaConsumer_Service"><path codeline="46" d="M491.79,168.652 C488.52,209.352 480.0002,315.3712 476.7102,356.3512 " fill="transparent" id="KafkaConsumer-to-Service" style="stroke:#A80036;stroke-width:1;"></path><polygon fill="#A80036" points="476.23,362.332,480.9374,353.6809,476.6301,357.348,472.9631,353.0407,476.23,362.332" style="stroke:#A80036;stroke-width:1;"></polygon></g><!--link Service to Repository--><g id="link_Service_Repository"><path codeline="47" d="M473.28,394.742 C470.4,420.072 465.3162,464.7902 462.4262,490.2702 " fill="transparent" id="Service-to-Repository" style="stroke:#A80036;stroke-width:1;"></path><polygon fill="#A80036" points="461.75,496.232,466.7388,487.7401,462.3135,491.2638,458.7898,486.8385,461.75,496.232" style="stroke:#A80036;stroke-width:1;"></polygon></g><!--link Service to Producer--><g id="link_Service_Producer"><path codeline="48" d="M487.96,394.742 C509.64,420.072 549.1283,466.1938 570.9383,491.6738 " fill="transparent" id="Service-to-Producer" style="stroke:#A80036;stroke-width:1;"></path><polygon fill="#A80036" points="574.84,496.232,572.0263,486.7936,571.5886,492.4335,565.9487,491.9958,574.84,496.232" style="stroke:#A80036;stroke-width:1;"></polygon></g><!--SRC=[RL5BReCm4Dtx57E1S8HigcwQJTMUm36Jr09ZQyPKYbBkNfjW_4aGOl4-ynupFEW9o3AA7zqZe77-1WRD6Oc5S58DyefWj8eQ-jKAuIu4G6AKfOW0X3UZvvdrXCmhit6PnSbhhp6nyL6Z3EhtIDpWlcpu8XhdLk7P-PswPMin8DcT9P-zUl985nbSN-WiQszfpNwYFydsiq9Aq-DtAPSWU-c2c1-hoNWllTpZ7aK_d7oHrlGSv6LeZQU8jKqgyirEF9koPZMKa7qpCpWysN5yyMjrpwxxEwwdxjOLTfaAqhfPAqr441PnXyCntInDsElNNBfiHAlOajX3bdy0]--></g></svg></p><h2 id="results">Results </h2>
<p>First of all, this structure held up very well during implementation and was successfully deployed to production without requiring major adjustments. In short: it works very well!</p>
<p>Here are some interesting observations:</p>
<h3 id="adapter-interchangeability">Adapter Interchangeability </h3>
<p>What I noticed quickly was that being able to replace adapters without affecting the business logic (which accounts for 90% of the code) was particularly useful in my case.</p>
<p>Let me explain:</p>
<p>One of my services, <strong>"unit-builder"</strong>, is resource-intensive: for a large volume of small texts (phrases, vocabulary words), it interacts with Google TTS to generate audio recordings, removes silences, adjusts speed, and encodes the result to mp3. <a href="../architecture/building-units-from-notes.html">More details here</a></p>
<p>Since KIAO is a non-commercial project, it’s important to keep operating costs low, and initially, only a small group of users will be allowed to publish units. That said, this shouldn’t prevent a future evolution toward a broader release of the “unit generation” feature. In the short term, it will be offered through a desktop application (V1), but eventually it may be moved to the cloud.</p>
<p>Now, in my cloud architecture, I prefer integrating services through Kafka (for fault tolerance, resilience to load spikes, etc.), while I’d like to avoid embedding Kafka in the desktop app or exposing the cloud Kafka instance. In short, the business logic is the same, but the communication methods differ.</p>
<p>Here are the two configurations I just mentioned:</p>
<h4 id="unit-generation-in-the-desktop-application-v1">Unit Generation in the Desktop Application (V1) </h4>
<p class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="DESCRIPTION" height="145px" preserveAspectRatio="none" style="width:1073px;height:145px;background:#FFFFFF;" version="1.1" viewBox="0 0 1073 145" width="1073px" zoomAndPan="magnify"><defs></defs><g><!--cluster Thick Client--><g id="cluster_Thick Client"><polygon fill="transparent" points="129,17.3417,139,7.3417,546,7.3417,546,110.3417,536,120.3417,129,120.3417,129,17.3417" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="536" x2="546" y1="17.3417" y2="7.3417"></line><line style="stroke:#181818;stroke-width:1;" x1="129" x2="536" y1="17.3417" y2="17.3417"></line><line style="stroke:#181818;stroke-width:1;" x1="536" x2="536" y1="17.3417" y2="120.3417"></line><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="82.0957" x="292.4521" y="35.3077">Thick Client</text></g><!--cluster Cloud--><g id="cluster_Cloud"><path d="M681.525,20.3836 C690.8957,8.0665 700.9179,8.5576 708.8101,21.9526 C717.4111,8.5526 725.891,9.4436 735.1324,21.2847 C742.3969,6.8197 750.9848,8.7451 760.3515,19.1531 C769.6263,7.6931 778.0412,8.446 785.7853,20.7886 C792.4998,10.9945 800.1477,10.4149 807.5581,20.007 C815.8176,6 828.4989,10.1298 834.5973,22.244 C842.2831,10.2629 850.6985,9.3356 861.1339,18.8495 C868.0733,9.2305 879.2834,9.2642 884.9269,20.3395 C893.0991,8.6216 902.7708,12.0738 908.9386,22.5117 C914.6927,10.9806 927.2143,7.6934 935.1884,20.0746 C942.5023,10.527 951.3946,7.1242 958.8102,19.9673 C967.6888,7.4859 980.1963,10.796 985.0205,24.09 C991.2102,12.7318 1001.8652,11.276 1010.734,20.7894 C1022.2337,10.7936 1034.3579,11.1747 1040,27.3417 C1042.2032,26.3377 1043.5203,27.5778 1043.1627,29.8294 C1062.2041,40.3853 1061.1532,54.6612 1046.1157,67.8631 C1066.2656,88.0891 1060.5918,106.1937 1033,112.3417 C1035.9914,111.9606 1037.0961,113.0759 1036.3699,116.0621 C1027.2765,128.0141 1018.7306,128.8481 1010.841,114.8766 C1004.3234,127.4626 993.5925,127.8865 986.1481,115.8042 C981.4719,128.7994 971.261,129.0433 962.2833,120.5902 C954.3206,132.3839 945.0201,133.4002 935.788,122.0429 C928.1272,136.3405 917.4897,135.3967 909.1396,122.7238 C903.5092,135.2753 892.7299,135.3605 886.1151,123.6583 C879.0552,138.199 867.352,137.5378 858.0281,126.1066 C848.7382,135.5246 840.8446,136.5987 834.4733,123.106 C826.2273,136.3042 816.5835,137.5331 808.0121,123.4213 C798.4687,136.8108 790.5857,134.1051 782.1176,122.3155 C774.2987,131.0401 764.017,131.161 759.3803,118.8723 C751.6042,133.4185 739.7548,131.2582 732.4234,118.4343 C725.9422,128.9968 713.8959,130.6324 707.2561,118.6109 C690.6971,127.9877 679.3645,124.0213 674,105.3417 C676.0904,105.9633 676.435,107.618 674.9608,109.141 C656.5684,100.2607 651.9608,85.2807 667.1659,69.7517 C645.6619,48.9862 653.7051,27.4442 681,20.3417 C681.1995,20.1135 681.3678,20.0818 681.525,20.3836 " fill="transparent" style="stroke:#181818;stroke-width:1;"></path><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="39.9139" x="837.0431" y="40.3077">Cloud</text></g><!--entity Notes Service--><g id="elem_Notes Service"><rect fill="#F1F1F1" height="49.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129.1096" x="145" y="50.8417"></rect><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="254.1096" y="55.8417"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="252.1096" y="57.8417"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="252.1096" y="61.8417"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.1096" x="160" y="85.8077">Notes Service</text></g><!--entity Builder--><g id="elem_Builder"><rect fill="#F1F1F1" height="49.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.2638" x="443" y="50.8417"></rect><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="510.2638" y="55.8417"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="508.2638" y="57.8417"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="508.2638" y="61.8417"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.2638" x="458" y="85.8077">Builder</text></g><!--entity Nginx--><g id="elem_Nginx"><polygon fill="#F1F1F1" points="682,60.8417,692,50.8417,758.9319,50.8417,758.9319,89.9097,748.9319,99.9097,682,99.9097,682,60.8417" style="stroke:#181818;stroke-width:0.5;"></polygon><line style="stroke:#181818;stroke-width:0.5;" x1="748.9319" x2="758.9319" y1="60.8417" y2="50.8417"></line><line style="stroke:#181818;stroke-width:0.5;" x1="682" x2="748.9319" y1="60.8417" y2="60.8417"></line><line style="stroke:#181818;stroke-width:0.5;" x1="748.9319" x2="748.9319" y1="60.8417" y2="99.9097"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.9319" x="697" y="85.8077">nginx</text></g><!--entity Units Service--><g id="elem_Units Service"><rect fill="#F1F1F1" height="49.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124.6017" x="907" y="50.8417"></rect><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1011.6017" y="55.8417"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1009.6017" y="57.8417"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1009.6017" y="61.8417"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.6017" x="922" y="85.8077">Units Service</text></g><!--entity User--><g id="elem_User"><ellipse cx="21.3089" cy="44.3417" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"></ellipse><path d="M21.3089,52.3417 L21.3089,79.3417 M8.3089,60.3417 L34.3089,60.3417 M21.3089,79.3417 L8.3089,94.3417 M21.3089,79.3417 L34.3089,94.3417 " fill="transparent" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="6" y="110.8077">User</text></g><!--link User to Notes Service--><g id="link_User_Notes Service"><path d="M37.1,75.3417 C60.13,75.3417 100.28,75.3417 138.89,75.3417 " fill="transparent" id="User-to-Notes Service" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="144.89,75.3417,135.89,71.3417,139.89,75.3417,135.89,79.3417,144.89,75.3417" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44.9931" x="68" y="71.2387">publish</text></g><!--link Notes Service to Builder--><g id="link_Notes Service_Builder"><path d="M274.28,75.3417 C326.01,75.3417 391.49,75.3417 436.61,75.3417 " fill="transparent" id="Notes Service-to-Builder" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="442.61,75.3417,433.61,71.3417,437.61,75.3417,433.61,79.3417,442.61,75.3417" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.6921" x="305" y="71.2387">REST PublishNote</text></g><!--link Builder to Nginx--><g id="link_Builder_Nginx"><path d="M530.05,75.3417 C573.48,75.3417 634.25,75.3417 675.82,75.3417 " fill="transparent" id="Builder-to-Nginx" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="681.82,75.3417,672.82,71.3417,676.82,75.3417,672.82,79.3417,681.82,75.3417" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.5281" x="563" y="71.2387">REST UnitBuilt</text></g><!--link Nginx to Units Service--><g id="link_Nginx_Units Service"><path d="M759.01,75.3417 C798.15,75.3417 854.16,75.3417 900.57,75.3417 " fill="transparent" id="Nginx-to-Units Service" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="906.57,75.3417,897.57,71.3417,901.57,75.3417,897.57,79.3417,906.57,75.3417" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.5281" x="790" y="71.2387">REST UnitBuilt</text></g><!--SRC=[POxD2i9038JlUOfXxxw01m-AroBQdiI3RgCDBhkoJKKGtzscHVmx9MI-cKdWeq8JifmQHIsPlKgAH7klASDLBMU7VGjRAAQQuSf6_1cB81pLuKx0jaZABJQSh-9vPvTv9w7clAC7aG-fg-4MDaR361HF4cz3Uc6RsQee-X7KcwqOaydijmHJNBf3aBQXNsMWNm_qt7gvAR4QOKFfBHewbBymUy1KfV4yP7r_zOS-0G00]--></g></svg></p><h4 id="unit-generation-in-the-cloud-v2">Unit Generation in the Cloud (V2) </h4>
<p class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="DESCRIPTION" height="172px" preserveAspectRatio="none" style="width:1223px;height:172px;background:#FFFFFF;" version="1.1" viewBox="0 0 1223 172" width="1223px" zoomAndPan="magnify"><defs></defs><g><!--cluster Thick Client--><g id="cluster_Thick Client"><polygon fill="transparent" points="129,29.2868,139,19.2868,290,19.2868,290,118.2868,280,128.2868,129,128.2868,129,29.2868" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="280" x2="290" y1="29.2868" y2="19.2868"></line><line style="stroke:#181818;stroke-width:1;" x1="129" x2="280" y1="29.2868" y2="29.2868"></line><line style="stroke:#181818;stroke-width:1;" x1="280" x2="280" y1="29.2868" y2="128.2868"></line><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="82.0957" x="164.4521" y="47.2527">Thick Client</text></g><!--cluster Cloud--><g id="cluster_Cloud"><path d="M451.3231,37.8135 C470.5333,12.1051 490.6785,13.819 508.0717,39.808 C523.0187,15.7315 543.0505,17.5764 557.6282,40.1999 C574.9744,19.0284 592.5579,14.2817 610.1289,39.9478 C621.8527,11.5023 646.2429,12.9226 663.5091,33.9702 C675.7427,10.2859 701.9615,8.1122 717.6964,29.7875 C739.3407,9.4409 754.3183,14.9581 768.6319,38.3286 C782.519,8.2887 804.5043,9.4443 823.7119,32.8449 C841.9876,7.1705 861.0422,6.4916 876.9602,35.1553 C889.3188,13.2563 911.9501,6 928.477,30.5303 C945.3345,9.8363 972.5011,8.5315 981.8814,38.4239 C996.0633,11.9303 1021.7328,9.8571 1040.2679,33.3378 C1060.1316,6.5155 1076.0912,10.4348 1092.3769,36.8405 C1110.0724,14.9484 1128.2893,10.3461 1144.6582,38.2339 C1159.2296,12.4105 1186.4774,9.9845 1200,39.2868 C1202.5209,39.0739 1203.8074,40.3305 1202.8916,42.8819 C1210.6663,47.8254 1211.3499,56.3751 1203.3535,61.7057 C1213.3478,64.4944 1216.2689,74.5452 1208.8518,82.0415 C1215.6096,89.3376 1216.1841,95.8422 1205.7964,100.2635 C1212.0471,113.5091 1208.7902,122.7817 1193,124.2868 C1195.3648,122.7286 1197.346,122.7414 1198.1138,125.9869 C1185.0109,156.58 1160.6218,155.4511 1143.6495,129.7291 C1126.5248,154.1217 1110.6117,155.6412 1092.186,131.0972 C1077.4939,155.3088 1062.1086,159.0549 1042.0093,136.9556 C1025.5662,164.5733 1001.5837,162.8314 984.6618,137.4738 C968.7367,158.4577 947.6884,157.2098 935.0607,133.7904 C914.6422,161.0064 897.1104,155.8189 878.0333,132.2831 C864.0357,157.3755 845.1434,157.6108 829.0145,134.4482 C810.5993,163.8801 789.3953,159.068 771.3803,134.0248 C758.7451,164.1036 736.2785,159.3831 718.3492,139.6625 C696.7902,165.6842 681.2919,162.5048 666.522,133.2922 C647.7784,157.2747 630.0762,153.6189 613.9553,130.3731 C598.3077,158.2973 574.9515,165.3361 555.2787,134.3846 C539.0946,153.8496 516.3093,155.6146 505.1722,128.9076 C480.7187,160.5596 451.3815,154.3766 439,117.2868 C441.6148,117.0361 443.0851,118.2621 442.2142,121.0159 C431.3364,118.1629 430.0798,109.0318 436.4203,101.1556 C424.0795,98.0731 419.0663,90.1296 427.0719,78.6105 C421.1778,69.9323 423.984,64.0441 434.1133,62.271 C421.8922,46.0818 426.1619,35.7667 446,32.2868 C450.0299,31.5516 452.4603,33.5718 451.3231,37.8135 " fill="transparent" style="stroke:#181818;stroke-width:1;"></path><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="39.9139" x="799.5431" y="52.2527">Cloud</text></g><!--entity Notes Service--><g id="elem_Notes Service"><rect fill="#F1F1F1" height="49.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129.1096" x="145" y="62.7868"></rect><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="254.1096" y="67.7868"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="252.1096" y="69.7868"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="252.1096" y="73.7868"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.1096" x="160" y="97.7527">Notes Service</text></g><!--entity Nginx--><g id="elem_Nginx"><polygon fill="#F1F1F1" points="447,72.7868,457,62.7868,523.9319,62.7868,523.9319,101.8547,513.9319,111.8547,447,111.8547,447,72.7868" style="stroke:#181818;stroke-width:0.5;"></polygon><line style="stroke:#181818;stroke-width:0.5;" x1="513.9319" x2="523.9319" y1="72.7868" y2="62.7868"></line><line style="stroke:#181818;stroke-width:0.5;" x1="447" x2="513.9319" y1="72.7868" y2="72.7868"></line><line style="stroke:#181818;stroke-width:0.5;" x1="513.9319" x2="513.9319" y1="72.7868" y2="111.8547"></line><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.9319" x="462" y="97.7527">nginx</text></g><!--entity Builder--><g id="elem_Builder"><rect fill="#F1F1F1" height="49.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.2638" x="693" y="62.7868"></rect><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="760.2638" y="67.7868"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="758.2638" y="69.7868"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="758.2638" y="73.7868"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.2638" x="708" y="97.7527">Builder</text></g><!--entity Units Service--><g id="elem_Units Service"><rect fill="#F1F1F1" height="49.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124.6017" x="1067" y="62.7868"></rect><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1171.6017" y="67.7868"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1169.6017" y="69.7868"></rect><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1169.6017" y="73.7868"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.6017" x="1082" y="97.7527">Units Service</text></g><!--entity Kafka--><g id="elem_Kafka"><path d="M900,66.7868 L946.6659,66.7868 C951.6659,66.7868 951.6659,81.3208 951.6659,81.3208 C951.6659,81.3208 951.6659,95.8547 946.6659,95.8547 L900,95.8547 C895,95.8547 895,81.3208 895,81.3208 C895,81.3208 895,66.7868 900,66.7868 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"></path><path d="M946.6659,66.7868 C941.6659,66.7868 941.6659,81.3208 941.6659,81.3208 C941.6659,95.8547 946.6659,95.8547 946.6659,95.8547 " fill="transparent" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.6659" x="900" y="86.7527">Kafka</text></g><!--entity User--><g id="elem_User"><ellipse cx="21.3089" cy="56.2868" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"></ellipse><path d="M21.3089,64.2868 L21.3089,91.2868 M8.3089,72.2868 L34.3089,72.2868 M21.3089,91.2868 L8.3089,106.2868 M21.3089,91.2868 L34.3089,106.2868 " fill="transparent" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="6" y="122.7527">User</text></g><!--link User to Notes Service--><g id="link_User_Notes Service"><path d="M37.1,87.2868 C60.13,87.2868 100.28,87.2868 138.89,87.2868 " fill="transparent" id="User-to-Notes Service" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="144.89,87.2868,135.89,83.2868,139.89,87.2868,135.89,91.2868,144.89,87.2868" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44.9931" x="68" y="83.1838">publish</text></g><!--link Notes Service to Nginx--><g id="link_Notes Service_Nginx"><path d="M274.05,87.2868 C327.48,87.2868 396.08,87.2868 440.62,87.2868 " fill="transparent" id="Notes Service-to-Nginx" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="446.62,87.2868,437.62,83.2868,441.62,87.2868,437.62,91.2868,446.62,87.2868" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.6921" x="307" y="83.1838">REST PublishNote</text></g><!--link Nginx to Builder--><g id="link_Nginx_Builder"><path d="M524.05,87.2868 C569.29,87.2868 639.13,87.2868 686.63,87.2868 " fill="transparent" id="Nginx-to-Builder" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="692.63,87.2868,683.63,83.2868,687.63,87.2868,683.63,91.2868,692.63,87.2868" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.6921" x="555" y="83.1838">REST PublishNote</text></g><!--link Builder to Kafka--><g id="link_Builder_Kafka"><path d="M780.41,85.8968 C815.63,84.7568 858.4831,83.361 888.7531,82.381 " fill="transparent" id="Builder-to-Kafka" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="894.75,82.1868,885.6253,78.4801,889.7526,82.3486,885.8841,86.4759,894.75,82.1868" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.4691" x="811" y="79.1838">UnitBuilt</text></g><!--link Kafka to Units Service--><g id="link_Kafka_Units Service"><path d="M952.01,82.0968 C981.27,82.9568 1022.5026,84.1712 1060.7426,85.2912 " fill="transparent" id="Kafka-to-Units Service" style="stroke:#181818;stroke-width:1;"></path><polygon fill="#181818" points="1066.74,85.4668,1057.861,81.205,1061.7421,85.3204,1057.6268,89.2016,1066.74,85.4668" style="stroke:#181818;stroke-width:1;"></polygon><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.4691" x="983" y="79.1838">UnitBuilt</text></g><!--SRC=[RO-zZW8n38HxFyKeFIzm1GM82WcT-AaGnP8rh4MKt6KTX8HuTzQxeECGLKQPp-Dnu8D24x8S6qKjcRrAYaILrvJXDYrdXwg52OgfPhXr8_w4QH2Ewd0bOBj8oYrMdC_YUKSt8XzIgU6czWpGC1oF4YzzuiAK3K-AX9hpplGcYhu40R-5IpSshmwdobcm5S5eD7vVYY_yb7sGjg5tn-X-MySiPwirlWVGC1gCFl1Pv1FsPnhwwDE1LjWifUTV7_N_ZbVk3W00]--></g></svg></p><p>In fact, much later, the thick client (based on web technologies) is also planned to be moved to the cloud — this is a V3, which is not described here.</p>
<p>To adapt to these technical configurations, hexagonal architecture is a huge advantage, since the clear separation between adapters (which vary by environment) and the core (shielded from external changes) minimizes the amount of differing code in each case. Thus, I can select the Kafka adapter, the REST adapter, or both through a simple configuration:</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml yaml"><code><span class="token key atrule">kiao</span><span class="token punctuation">:</span>
  <span class="token key atrule">unit-builder</span><span class="token punctuation">:</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token key atrule">unit-built-publisher</span><span class="token punctuation">:</span>
        <span class="token key atrule">adapters</span><span class="token punctuation">:</span>
          <span class="token key atrule">kafka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
          <span class="token key atrule">rest</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">rest</span><span class="token punctuation">:</span>
          <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//www.kiao<span class="token punctuation">-</span>lp.app/api/units/unit<span class="token punctuation">-</span>built
          <span class="token key atrule">apiKey</span><span class="token punctuation">:</span> MY_API_KEY_IS_SECRET_DONT_EXPECT_IT_HERE
</code></pre><p>Convenient, right?</p>
<h3 id="an-unusual-structure">An Unusual Structure </h3>
<p>This structure can also be surprising for developers unfamiliar with it. One must understand the boundaries between the core and the adapters to preserve them. However, once you get used to it, you come to appreciate its depth and intuitiveness.</p>
<h2 id="conclusion">Conclusion </h2>
<p>Using hexagonal architecture as inspiration for structuring a microservice is easy and generally beneficial. The small initial learning curve to understand and explain the underlying concepts is quickly forgotten when you can easily find what you're looking for. Beyond this convenience, as soon as communication flexibility is needed, the hexagonal approach truly shines.</p>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>